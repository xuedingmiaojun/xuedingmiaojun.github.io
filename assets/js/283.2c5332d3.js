(window.webpackJsonp=window.webpackJsonp||[]).push([[283],{569:function(t,a,v){"use strict";v.r(a);var _=v(2),r=Object(_.a)({},function(){var t=this,a=t.$createElement,v=t._self._c||a;return v("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[v("p",[t._v("说一说微信活码"),v("br")]),t._v(" "),v("h3",{attrs:{id:"什么是活码"}},[v("a",{staticClass:"header-anchor",attrs:{href:"#什么是活码","aria-hidden":"true"}},[t._v("#")]),t._v(" 什么是活码")]),t._v(" "),v("blockquote",[v("p",[t._v("活码"),v("br"),t._v("\n对一个分配的短网址进行编码生成二维码。生成后可以随时修改内容，二维码图案不变，可跟踪扫描统计，支持存储大量文字、图片、文件、音视、视频等内容，同时图案简单易扫。")])]),t._v(" "),v("p",[t._v("微信活码就是动态的微信二维码了(主要是群聊二维码)")]),t._v(" "),v("h3",{attrs:{id:"为什么需要"}},[v("a",{staticClass:"header-anchor",attrs:{href:"#为什么需要","aria-hidden":"true"}},[t._v("#")]),t._v(" 为什么需要?")]),t._v(" "),v("p",[t._v("在微信生态中我们的公众号、微信群、微信号中默认使用的是静态的二维码，通过此二维码可以关注公众号，进入微信群等。但是微信群的二维码会有七天过期的问题。")]),t._v(" "),v("p",[t._v("这个其实主要是解决二维码过期问题。")]),t._v(" "),v("h3",{attrs:{id:"原理简述"}},[v("a",{staticClass:"header-anchor",attrs:{href:"#原理简述","aria-hidden":"true"}},[t._v("#")]),t._v(" 原理简述")]),t._v(" "),v("p",[t._v("1.对外公开一个固定的二维码，二维码解析出来的 url 是固定死的，对应的是一个固定的网页链接，而不是真正的微信群聊二维码"),v("br"),t._v("\nps：使用草料二维码对微信群聊二维码进行解码我们会得到类似如下格式的地址(g 字母以后部分是群聊对应的一串编码)"),v("br"),t._v(" "),v("a",{attrs:{"data-fancybox":"",title:"微信群聊二维码解析结果",href:"http://cdn.xuedingmiao.com/wx-qun-code-url.png"}},[v("img",{staticStyle:{width:"90%",display:"block"},attrs:{src:"http://cdn.xuedingmiao.com/wx-qun-code-url.png"}})]),v("br"),t._v("\n2.这个固定的网页链接打开之后，里面显示的二维码则是真正的微信群聊二维码。"),v("br"),t._v("\n3.可以假定如果二维码的显示超过200次(群聊200人扫码进群上限)，则表示微信群已经满人需要显示另外一个二维码。")]),t._v(" "),v("h4",{attrs:{id:"加强"}},[v("a",{staticClass:"header-anchor",attrs:{href:"#加强","aria-hidden":"true"}},[t._v("#")]),t._v(" 加强")]),t._v(" "),v("p",[t._v("因为用户首先打开的是我们自己的页面，所以可以增加很多自定义功能"),v("br"),t._v("\n可以根据客户端用户代理(user-agent)区分用户")]),t._v(" "),v("ul",[v("li",[t._v("根据终端设备类型做分流区分不同设备的用户")]),t._v(" "),v("li",[t._v("根据 IP 区分显示，分流不同地区的用户")])]),t._v(" "),v("h3",{attrs:{id:"优缺点"}},[v("a",{staticClass:"header-anchor",attrs:{href:"#优缺点","aria-hidden":"true"}},[t._v("#")]),t._v(" 优缺点")]),t._v(" "),v("p",[t._v("优点：")]),t._v(" "),v("ul",[v("li",[t._v("部分解决7天过期问题")]),t._v(" "),v("li",[t._v("自定义导流")])]),t._v(" "),v("p",[t._v("缺点：")]),t._v(" "),v("ul",[v("li",[t._v("用户需要两次跳转，流程变长")]),t._v(" "),v("li",[t._v("扫码加群成功没有回调，无法确定用户是否真的进群")]),t._v(" "),v("li",[t._v("没满人的二维码最终还是会过期，需手动维护")]),t._v(" "),v("li",[t._v("满人后无法解决加群问题")])]),t._v(" "),v("h3",{attrs:{id:"简易实现"}},[v("a",{staticClass:"header-anchor",attrs:{href:"#简易实现","aria-hidden":"true"}},[t._v("#")]),t._v(" 简易实现")]),t._v(" "),v("p",[t._v("本站的技术交流群二维码就是一个简易活码，下面大概介绍下实现过程。"),v("br"),t._v("\n主要基于 koa + 云开发 + 测试公众号(都是免费的)进行实现：")]),t._v(" "),v("ul",[v("li",[t._v("云开发的云数据库中新建记录用于存放二维码的更新(上传)时间及是否发送过二维码过期提醒")]),t._v(" "),v("li",[t._v("测试公众号新建一个模板消用于提醒群主二维码将过期")]),t._v(" "),v("li",[t._v("基于 koa 实现一个静态服务器展示一个中间页(用于跳转显示群聊二维码)。")]),t._v(" "),v("li",[t._v("中间页内部使用插件以群聊二维码的 url 作为参数生成二维码并展示。")]),t._v(" "),v("li",[t._v("静态服务器提供一个上传页面，打开后可以直接进行群聊二维码的上传。")]),t._v(" "),v("li",[t._v("上传成功之后会把上传时间更新到云数据库中，并把提醒状态置为 false (未提醒)")]),t._v(" "),v("li",[t._v("云开发中新建一个云函数用于检查二维码是否将要过期，要过期就发送模板消息提醒群主并把云数据库中的发送记录置为 true (已提醒)")]),t._v(" "),v("li",[t._v("模板消息中的 url 可设置为二维码的上传页面，这样收到提醒之后保存新的二维码即可点击模板消息进行新二维码的上传")]),t._v(" "),v("li",[t._v("云开发的云函数设置一个定时触发器，例如定为每天 10 点检查")])]),t._v(" "),v("p",[t._v("至此一个简易实现就完成了，然后就可以在过期前收到测试公众号发来的过期提醒模板消息了。")]),t._v(" "),v("p",[t._v("提醒效果："),v("br"),t._v(" "),v("a",{attrs:{"data-fancybox":"",title:"过期提醒模板消息",href:"http://cdn.xuedingmiao.com/expire-template-msg.jpg"}},[v("img",{staticStyle:{width:"50%",display:"block"},attrs:{src:"http://cdn.xuedingmiao.com/expire-template-msg.jpg"}})])])])},[],!1,null,null,null);a.default=r.exports}}]);