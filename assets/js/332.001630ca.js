(window.webpackJsonp=window.webpackJsonp||[]).push([[332],{621:function(t,a,s){"use strict";s.r(a);var n=s(2),e=Object(n.a)({},function(){var t=this,a=t.$createElement,s=t._self._c||a;return s("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[s("p",[t._v("记一下小程序分享朋友圈功能的实现"),s("br")]),t._v(" "),s("p",[t._v("分享朋友圈很适合内容型小程序，所以就在博客小程序里加了这个功能(可能也用不到😄)")]),t._v(" "),s("p"),s("div",{staticClass:"table-of-contents"},[s("ul",[s("li",[s("a",{attrs:{href:"#基础库要求"}},[t._v("基础库要求")])]),s("li",[s("a",{attrs:{href:"#设置分享状态"}},[t._v("设置分享状态")])]),s("li",[s("a",{attrs:{href:"#真机效果"}},[t._v("真机效果")])]),s("li",[s("a",{attrs:{href:"#注意事项"}},[t._v("注意事项")])]),s("li",[s("a",{attrs:{href:"#错误处理"}},[t._v("错误处理")])]),s("li",[s("a",{attrs:{href:"#参考资料"}},[t._v("参考资料")])])])]),s("p"),t._v(" "),s("h3",{attrs:{id:"基础库要求"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#基础库要求","aria-hidden":"true"}},[t._v("#")]),t._v(" 基础库要求")]),t._v(" "),s("ul",[s("li",[t._v("基础库需要2.11.3版本以上")]),t._v(" "),s("li",[t._v("目前仅支持安卓")])]),t._v(" "),s("h3",{attrs:{id:"设置分享状态"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#设置分享状态","aria-hidden":"true"}},[t._v("#")]),t._v(" 设置分享状态")]),t._v(" "),s("p",[t._v("需同时允许两个设置")]),t._v(" "),s("ul",[s("li",[t._v("设置允许“发送给朋友”(shareAppMessage)")]),t._v(" "),s("li",[t._v("设置允许“分享到朋友圈”(shareTimeline)")])]),t._v(" "),s("p",[t._v("注意：事件处理函数返回一个 Object，用于自定义分享内容，不支持自定义页面路径")]),t._v(" "),s("div",{staticClass:"language-js extra-class"},[s("pre",{pre:!0,attrs:{class:"language-js"}},[s("code",[t._v("\n"),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("mounted")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    wx"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("showShareMenu")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" menus"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'shareAppMessage'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'shareTimeline'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("onShareAppMessage")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("return")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n        title"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'标题'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n        path"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'/pages/blog/main'")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("onShareTimeline")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("return")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n        title"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'标题'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n        query"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'a=1'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 自定义页面路径中携带的参数，如 path?a=1&b=2 的 “?” 后面部分")]),t._v("\n        imageUrl"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("''")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 自定义图片路径，显示图片长宽比是 1:1，默认使用小程序 Logo")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n")])])]),s("h3",{attrs:{id:"真机效果"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#真机效果","aria-hidden":"true"}},[t._v("#")]),t._v(" 真机效果")]),t._v(" "),s("img",{staticStyle:{width:"50%",display:"inline-block"},attrs:{src:"/images/xcx-sharepyq.jpg"}}),t._v(" "),s("h3",{attrs:{id:"注意事项"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#注意事项","aria-hidden":"true"}},[t._v("#")]),t._v(" 注意事项")]),t._v(" "),s("ul",[s("li",[t._v("低版本微信客户端打开时，会进入一个升级提示页面")]),t._v(" "),s("li",[t._v("不支持在小程序页面内直接发起分享")]),t._v(" "),s("li",[t._v("自定义分享内容时不支持自定义页面路径")]),t._v(" "),s("li",[t._v("存在 web-view 组件的页面不支持发起分享")]),t._v(" "),s("li",[t._v("支持打开开发版、体验版，无权限人员进入时页面会提示无权限")])]),t._v(" "),s("h3",{attrs:{id:"错误处理"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#错误处理","aria-hidden":"true"}},[t._v("#")]),t._v(" 错误处理")]),t._v(" "),s("p",[t._v("如果有调用云函数的话可能会出现-404011云函数调用失败的问题，官方应该在修复了")]),t._v(" "),s("h3",{attrs:{id:"参考资料"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#参考资料","aria-hidden":"true"}},[t._v("#")]),t._v(" 参考资料")]),t._v(" "),s("ul",[s("li",[s("a",{attrs:{href:"https://developers.weixin.qq.com/miniprogram/dev/framework/open-ability/share-timeline.html",target:"_blank",rel:"noopener noreferrer"}},[t._v("分享到朋友圈（Beta）"),s("OutboundLink")],1)]),t._v(" "),s("li",[s("a",{attrs:{href:"https://developers.weixin.qq.com/miniprogram/dev/reference/api/Page.html#onShareAppMessage-Object-object",target:"_blank",rel:"noopener noreferrer"}},[t._v("Page.onShareAppMessage"),s("OutboundLink")],1)]),t._v(" "),s("li",[s("a",{attrs:{href:"https://developers.weixin.qq.com/miniprogram/dev/reference/api/Page.html#onShareTimeline",target:"_blank",rel:"noopener noreferrer"}},[t._v("Page.onShareTimeline"),s("OutboundLink")],1)]),t._v(" "),s("li",[s("a",{attrs:{href:"https://developers.weixin.qq.com/miniprogram/product/#_5-1-%E6%BB%A5%E7%94%A8%E5%88%86%E4%BA%AB%E8%A1%8C%E4%B8%BA",target:"_blank",rel:"noopener noreferrer"}},[t._v("《微信小程序平台运营规范》"),s("OutboundLink")],1)])])])},[],!1,null,null,null);a.default=e.exports}}]);