(window.webpackJsonp=window.webpackJsonp||[]).push([[253],{540:function(t,s,e){"use strict";e.r(s);var r=e(2),a=Object(r.a)({},function(){var t=this,s=t.$createElement,e=t._self._c||s;return e("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[e("p",[t._v("记录下如何对uni-app项目进行多环境打包部署改造"),e("br")]),t._v(" "),e("h3",{attrs:{id:"环境区分"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#环境区分","aria-hidden":"true"}},[t._v("#")]),t._v(" 环境区分")]),t._v(" "),e("blockquote",[e("p",[t._v("官方文档说明："),e("br"),t._v("\n开发环境和生产环境"),e("br"),t._v("\nuni-app 可通过 process.env.NODE_ENV 判断当前环境是开发环境还是生产环境。一般用于连接测试服务器或生产服务器的动态切换。"),e("br"),t._v("\n在HBuilderX 中，点击“运行”编译出来的代码是开发环境，点击“发行”编译出来的代码是生产环境")])]),t._v(" "),e("h3",{attrs:{id:"解决方案"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#解决方案","aria-hidden":"true"}},[t._v("#")]),t._v(" 解决方案")]),t._v(" "),e("ol",[e("li",[t._v("使用基于vue-cli命令行方式创建项目")]),t._v(" "),e("li",[t._v("添加必要的环境变量， VUE_APP_ 起始，例如 VUE_APP_BASE_API"),e("br"),t._v("\n即在项目根目录新建不同环境的变量配置文件，并分别写入环境所需配置\n"),e("ul",[e("li",[t._v(".env.development")]),t._v(" "),e("li",[t._v(".env.test")]),t._v(" "),e("li",[t._v(".env.production")])])]),t._v(" "),e("li",[t._v("然后可以通过 VUE_APP_BASE_API 访问"),e("br"),t._v("\n例如：在项目内请求接口的地方设置 baseurl 为 process.env.VUE_APP_BASE_API")]),t._v(" "),e("li",[t._v("修改 package.json"),e("br"),t._v("\n增加以下脚本，在启动或者打包时以切换不同服务器(不一定完全按照下方设置)。"),e("br"),t._v("\n这里的需求是在开发模式启动时方便切换开发、测试、生产环境的数据库方便验证问题，以及发行至各环境")])]),t._v(" "),e("div",{staticClass:"language-json extra-class"},[e("pre",{pre:!0,attrs:{class:"language-json"}},[e("code",[t._v("\n"),e("span",{pre:!0,attrs:{class:"token property"}},[t._v('"build:h5"')]),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token string"}},[t._v('"cross-env NODE_ENV=production UNI_PLATFORM=h5 vue-cli-service uni-build"')]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n"),e("span",{pre:!0,attrs:{class:"token property"}},[t._v('"build:h5-test"')]),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token string"}},[t._v('"cross-env NODE_ENV=test UNI_PLATFORM=h5 vue-cli-service uni-build"')]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n"),e("span",{pre:!0,attrs:{class:"token property"}},[t._v('"build:h5-dev"')]),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token string"}},[t._v('"cross-env NODE_ENV=development UNI_PLATFORM=h5 vue-cli-service uni-build"')]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" \n"),e("span",{pre:!0,attrs:{class:"token property"}},[t._v('"dev:h5"')]),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token string"}},[t._v('"cross-env NODE_ENV=production UNI_PLATFORM=h5 vue-cli-service uni-serve --watch"')]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n"),e("span",{pre:!0,attrs:{class:"token property"}},[t._v('"dev:h5-test"')]),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token string"}},[t._v('"cross-env NODE_ENV=test UNI_PLATFORM=h5 vue-cli-service uni-serve --watch"')]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n"),e("span",{pre:!0,attrs:{class:"token property"}},[t._v('"dev:h5-dev"')]),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token string"}},[t._v('"cross-env NODE_ENV=development UNI_PLATFORM=h5 vue-cli-service uni-serve --watch"')]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n")])])]),e("ol",{attrs:{start:"5"}},[e("li",[t._v("最后像普通vue项目一样使用就行了")])]),t._v(" "),e("div",{staticClass:"language- extra-class"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[t._v("npm run dev:h5-test\n")])])]),e("h3",{attrs:{id:"参考资料"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#参考资料","aria-hidden":"true"}},[t._v("#")]),t._v(" 参考资料")]),t._v(" "),e("ul",[e("li",[e("a",{attrs:{href:"https://ask.dcloud.net.cn/question/73096",target:"_blank",rel:"noopener noreferrer"}},[t._v("uni-app如何多环境配置部署，使用npm的方式"),e("OutboundLink")],1)]),t._v(" "),e("li",[e("a",{attrs:{href:"https://uniapp.dcloud.io/frame?id=%E5%BC%80%E5%8F%91%E7%8E%AF%E5%A2%83%E5%92%8C%E7%94%9F%E4%BA%A7%E7%8E%AF%E5%A2%83",target:"_blank",rel:"noopener noreferrer"}},[t._v("开发环境和生产环境"),e("OutboundLink")],1)]),t._v(" "),e("li",[e("router-link",{attrs:{to:"/blog/jnpf_app_cli.html"}},[t._v("命令行打包")])],1)])])},[],!1,null,null,null);s.default=a.exports}}]);