(window.webpackJsonp=window.webpackJsonp||[]).push([[286],{573:function(t,e,a){"use strict";a.r(e);var r=a(2),n=Object(r.a)({},function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[a("p",[t._v("记下调试微信登录时遇到的一个问题"),a("br")]),t._v(" "),a("p",[t._v("有个 h5 项目带了微信登录功能，功能是基于"),a("router-link",{attrs:{to:"/blog/wx_scan_login_demo.html"}},[t._v("微信网页授权")]),t._v("实现的，但是最近使用功能发现报了一个错：")],1),t._v(" "),a("h3",{attrs:{id:"现象"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#现象","aria-hidden":"true"}},[t._v("#")]),t._v(" 现象")]),t._v(" "),a("p",[t._v("在使用golang请求微信服务时，出现错误")]),t._v(" "),a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[t._v("x509: certificate signed by unknown authority\n")])])]),a("p",[t._v("错误是后端请求微信接口获取 openId/unionid 时出现的"),a("br"),t._v("\ngo实现的Client端默认要对服务端传过来的数字证书进行校验")]),t._v(" "),a("ul",[a("li",[t._v("注：后端服务是跑在 docker 容器里的")])]),t._v(" "),a("p",[t._v("原因是容器里没有ca证书，所以校验出错了。")]),t._v(" "),a("h3",{attrs:{id:"解决办法"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#解决办法","aria-hidden":"true"}},[t._v("#")]),t._v(" 解决办法")]),t._v(" "),a("p",[t._v("可以选择两种办法")]),t._v(" "),a("ul",[a("li",[t._v("① 修改 go 的 client 端忽略对服务端的证书校验"),a("br"),t._v("\n关键设置："),a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[t._v("tr := &http.Transport{\n    TLSClientConfig: &tls.Config{InsecureSkipVerify: true},\n}\n")])])])]),t._v(" "),a("li",[t._v("② 添加证书到docker镜像内即可"),a("br"),t._v("\n参考命令："),a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[t._v("ADD your_ca_root.crt /usr/local/share/ca-certificates/foo.crt\nRUN update-ca-certificates\n")])])])])]),t._v(" "),a("h3",{attrs:{id:"参考资料"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#参考资料","aria-hidden":"true"}},[t._v("#")]),t._v(" 参考资料")]),t._v(" "),a("ul",[a("li",[a("a",{attrs:{href:"https://askubuntu.com/questions/73287/how-do-i-install-a-root-certificate/377570#377570",target:"_blank",rel:"noopener noreferrer"}},[t._v("How do I install a root certificate?"),a("OutboundLink")],1)]),t._v(" "),a("li",[a("a",{attrs:{href:"https://developers.weixin.qq.com/community/develop/doc/00022c11520ee096bfe843ff051c00",target:"_blank",rel:"noopener noreferrer"}},[t._v("微信小程序登陆，如果使用docker容器获取openId的接口报错"),a("OutboundLink")],1)])])])},[],!1,null,null,null);e.default=n.exports}}]);